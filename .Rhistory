View(chen_pop_sp)
plot(chen_pop_sp[5])
plot(chen_pop_sp[7])
plot(chen_pop_sp[8])
plot(chen_pop_sp[6])
chen_pop_sp <- merge(chen_bdry, chen_pop, by.x = 'Name', by.y = 'Div', all.x = TRUE)
plot(plot(chen_pop_sp[6]))
chen_pop_sp <- merge(chen_bdry, chen_pop, by.x = 'Name', by.y = 'Div', all.x = TRUE)
plot(chen_pop_sp[6])
grid.arrange(plot(chen_pop_sp[6]),plot(chen_pop_sp[8]),nrow=1)
ggplot()+
geom_sf(data = chen_pop_sp, color = "grey", fill = "transparent")+
scale_colour_viridis(direction = -1,
discrete = FALSE, option = "D")+
labs(title="Mean Abs Error, Test Set, Model Time&Space&lag")+
mapTheme
ggplot()+
geom_sf(data = chen_pop_sp, color = "grey", fill = "transparent")+
scale_colour_viridis(direction = -1,
discrete = FALSE, option = "D")+
labs(title="Mean Abs Error, Test Set, Model Time&Space&lag")+
mapTheme()
ggplot()+
geom_sf(data = chen_pop_sp, color = chen_pop_sp[8], fill = "transparent")+
scale_colour_viridis(direction = -1,
discrete = FALSE, option = "D")+
labs(title="Mean Abs Error, Test Set, Model Time&Space&lag")+
mapTheme()
ggplot(chen_pop_sp)+
geom_sf(data = st_union(chen_pop_sp))+
geom_sf(aes(fill= chen_pop_sp$PopulationDensity))+
scale_fill_manual(values = palette5,
labels= qBr(allTracts.group, "TotalPop"),
name = "Population\n(Quintile Breaks)")+
labs(title = "Total Population by census tracts, 2009-2019",
subtitle = "Washington DC",
caption = "Figure 2.2")+
facet_wrap(~year)+
mapTheme()
ggplot(chen_pop_sp)+
geom_sf(data = st_union(chen_pop_sp))+
geom_sf(aes(fill= chen_pop_sp$PopulationDensity))+
scale_fill_manual(values = palette5,
name = "Population\n(Quintile Breaks)")+
labs(title = "Total Population by census tracts, 2009-2019",
subtitle = "Washington DC",
caption = "Figure 2.2")+
facet_wrap(~year)+
mapTheme()
plot(chen_pop_sp[6])
chen_pop_sp <- merge(chen_bdry, chen_pop, by.x = 'Name', by.y = 'Div', all.x = TRUE)
plot(chen_pop_sp[8])
plot(chen_pop_sp[6])
View(chen_slum)
plot(chen_slum[0])
View(chen_slum)
chen_bdry <- st_read("https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/gcc-divisions-latest.kml?token=GHSAT0AAAAAACM4UMDCNXPWYGVQ6LZESKBEZOBKQMA")
chen_bdry <- st_set_crs(chen_bdry, 4326)
chen_zone <- st_read('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/gcc-zones-latest.kml?token=GHSAT0AAAAAACM4UMDDRP6PRGP7J6VXKBZUZOBKQ2Q')
chen_slum <- st_read('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/chennai_slums.kml?token=GHSAT0AAAAAACM4UMDDSLLVAMRRTCPGZTPEZOBKMUA')%>%
st_transform('ESRI:102271')
chen_slum_bdry <- st_read("https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/chennai_slum_boundaries.kml?token=GHSAT0AAAAAACM4UMDCLCNN6TCNVCPK5YCWZOBKNMQ")
chen_pop <- read.csv('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/Chennai_pop_2020estimation.csv?token=GHSAT0AAAAAACM4UMDDAX3NFCPJGHH6GNXYZOBKOPA')
chen_bdry <- st_read("https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/gcc-divisions-latest.kml?token=GHSAT0AAAAAACM4UMDCNXPWYGVQ6LZESKBEZOBKQMA")
chen_bdry <- st_set_crs(chen_bdry, 4326)%>%
st_transform('ESRI:102271')
chen_zone <- st_read('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/gcc-zones-latest.kml?token=GHSAT0AAAAAACM4UMDDRP6PRGP7J6VXKBZUZOBKQ2Q')
chen_slum <- st_read('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/chennai_slums.kml?token=GHSAT0AAAAAACM4UMDDSLLVAMRRTCPGZTPEZOBKMUA')%>%
st_transform('ESRI:102271')
chen_slum_bdry <- st_read("https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/chennai_slum_boundaries.kml?token=GHSAT0AAAAAACM4UMDCLCNN6TCNVCPK5YCWZOBKNMQ")
chen_pop <- read.csv('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/Chennai_pop_2020estimation.csv?token=GHSAT0AAAAAACM4UMDDAX3NFCPJGHH6GNXYZOBKOPA')
fishnet <-
st_make_grid(chen_bdry,
cellsize = 500,
square = TRUE) %>%
.[chen_bdry] %>%
st_sf() %>%
mutate(uniqueID = 1:n())
slum_net <-
dplyr::select(chen_slum) %>%
mutate(countslum = 1) %>%
aggregate(., fishnet, sum) %>%
mutate(countslum = replace_na(countslum, 0),
uniqueID = 1:n(),
cvID = sample(round(nrow(fishnet) / 24),
size=nrow(fishnet), replace = TRUE))
ggplot() +
geom_sf(data = slum_net, aes(fill = countslum), color = NA) +
scale_fill_viridis() +
labs(title = "Count of Litter for the fishnet") +
mapTheme()
chen_pop_sp <- merge(chen_bdry, chen_pop, by.x = 'Name', by.y = 'Div', all.x = TRUE)
plot(chen_pop_sp[8])
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = chen_pop_sp$PopulationEsti2020), color = NA) +
scale_fill_viridis() +
labs(title = "Count of Litter for the fishnet") +
mapTheme()
chen_pop_sp <- merge(chen_bdry, chen_pop, by.x = 'Name', by.y = 'Div', all.x = TRUE)
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationEsti2020), color = NA) +
scale_fill_viridis() +
labs(title = "Popultion in Chennai") +
mapTheme()
chen_pop_sp <- merge(chen_bdry, chen_pop, by.x = 'Name', by.y = 'Div', all.x = TRUE)
grid.arrange(
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationEsti2020), color = NA) +
scale_fill_viridis() +
labs(title = "Popultion in Chennai") +
mapTheme(),
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationDensity), color = NA) +
scale_fill_viridis() +
labs(title = "Pop Density in Chennai") +
mapTheme()
)
chen_pop_sp <- merge(chen_bdry, chen_pop, by.x = 'Name', by.y = 'Div', all.x = TRUE)
grid.arrange(
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationEsti2020), color = NA) +
scale_fill_viridis() +
labs(title = "Popultion in Chennai") +
mapTheme(),
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationDensity), color = NA) +
scale_fill_viridis() +
labs(title = "Pop Density in Chennai") +
mapTheme(),nrow = 1
)
fishnet <-
st_make_grid(chen_bdry,
cellsize = 500,
square = TRUE) %>%
.[chen_bdry] %>%
st_sf() %>%
mutate(uniqueID = 1:n())
slum_net <-
dplyr::select(chen_slum) %>%
mutate(countslum = 1) %>%
aggregate(., fishnet, sum) %>%
mutate(countslum = replace_na(countslum, 0),
uniqueID = 1:n(),
cvID = sample(round(nrow(fishnet) / 24),
size=nrow(fishnet), replace = TRUE))
ggplot() +
geom_sf(data = slum_net, aes(fill = countslum), color = NA) +
scale_fill_viridis() +
labs(title = "Count of Litter for the fishnet") +
mapTheme()
chen_pop_sp <- merge(chen_bdry, chen_pop, by.x = 'Name', by.y = 'Div', all.x = TRUE)
grid.arrange(
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationEsti2020), color = NA) +
scale_fill_viridis() +
labs(title = "Popultion in Chennai") +
mapTheme(),
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationDensity), color = NA) +
scale_fill_viridis() +
labs(title = "Pop Density in Chennai") +
mapTheme(),nrow = 1
)
fishnet <-
st_make_grid(chen_bdry,
cellsize = 500,
square = TRUE) %>%
.[chen_bdry] %>%
st_sf() %>%
mutate(uniqueID = 1:n())
slum_net <-
dplyr::select(chen_slum) %>%
mutate(countslum = 1) %>%
aggregate(., fishnet, sum) %>%
mutate(countslum = replace_na(countslum, 0),
uniqueID = 1:n(),
cvID = sample(round(nrow(fishnet) / 24),
size=nrow(fishnet), replace = TRUE))
ggplot() +
geom_sf(data = slum_net, aes(fill = countslum), color = NA) +
scale_fill_viridis() +
labs(title = "Count of Litter for the fishnet") +
mapTheme()
fishnet <-
st_make_grid(chen_bdry,
cellsize = 500,
square = TRUE) %>%
.[chen_bdry] %>%
st_sf() %>%
mutate(uniqueID = 1:n())
slum_net <-
dplyr::select(chen_slum) %>%
mutate(countslum = 1) %>%
aggregate(., fishnet, sum) %>%
mutate(countslum = replace_na(countslum, 0),
uniqueID = 1:n(),
cvID = sample(round(nrow(fishnet) / 24),
size=nrow(fishnet), replace = TRUE))
ggplot() +
geom_sf(data = slum_net, aes(fill = countslum), color = NA) +
scale_fill_viridis() +
labs(title = "Slum count for the fishnet") +
mapTheme()
fishnet <-
st_make_grid(chen_bdry,
cellsize = 500,
square = TRUE) %>%
.[chen_bdry] %>%
st_sf() %>%
mutate(uniqueID = 1:n())
slum_net <-
dplyr::select(chen_slum) %>%
mutate(countslum = 1) %>%
aggregate(., fishnet, sum) %>%
mutate(countslum = replace_na(countslum, 0),
uniqueID = 1:n(),
cvID = sample(round(nrow(fishnet) / 24),
size=nrow(fishnet), replace = TRUE))
ggplot() +
geom_sf(data = slum_net, aes(fill = countslum), color = NA) +
scale_fill_viridis() +
labs(title = "Slum count for the fishnet") +
mapTheme()
ggplot() +
geom_sf(data = chen_bdry) +
geom_sf(data = chen_slum, colour="red", size=0.2, show.legend = "point") +
labs(title= "Litter, Chennai") +
mapTheme(title_size = 14)
fishnet <-
st_make_grid(chen_bdry,
cellsize = 500,
square = TRUE) %>%
.[chen_bdry] %>%
st_sf() %>%
mutate(uniqueID = 1:n())
slum_net <-
dplyr::select(chen_slum) %>%
mutate(countslum = 1) %>%
aggregate(., fishnet, sum) %>%
mutate(countslum = replace_na(countslum, 0),
uniqueID = 1:n(),
cvID = sample(round(nrow(fishnet) / 24),
size=nrow(fishnet), replace = TRUE))
grid.arrange(
ggplot() +
geom_sf(data = slum_net, aes(fill = countslum), color = NA) +
scale_fill_viridis() +
labs(title = "Slum count for the fishnet") +
mapTheme(),
ggplot() +
geom_sf(data = chen_bdry) +
geom_sf(data = chen_slum, colour="red", size=0.2, show.legend = "point") +
labs(title= "Litter, Chennai") +
mapTheme(title_size = 14),
nrow = 1
)
fishnet <-
st_make_grid(chen_bdry,
cellsize = 500,
square = TRUE) %>%
.[chen_bdry] %>%
st_sf() %>%
mutate(uniqueID = 1:n())
slum_net <-
dplyr::select(chen_slum) %>%
mutate(countslum = 1) %>%
aggregate(., fishnet, sum) %>%
mutate(countslum = replace_na(countslum, 0),
uniqueID = 1:n(),
cvID = sample(round(nrow(fishnet) / 24),
size=nrow(fishnet), replace = TRUE))
grid.arrange(
ggplot() +
geom_sf(data = slum_net, aes(fill = countslum), color = NA) +
scale_fill_viridis() +
labs(title = "Slum count for the fishnet") +
mapTheme(),
ggplot() +
geom_sf(data = chen_bdry) +
geom_sf(data = chen_slum, colour="red", size=0.2, show.legend = "point") +
labs(title= "Slum, Chennai") +
mapTheme(title_size = 14),
nrow = 1
)
chen_pop_sp <- merge(chen_bdry, chen_pop, by.x = 'Name', by.y = 'Div', all.x = TRUE)
grid.arrange(
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationEsti2020), color = NA) +
scale_fill_viridis() +
labs(title = "Popultion in Chennai") +
mapTheme(),
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationDensity), color = NA) +
scale_fill_viridis() +
labs(title = "Pop Density in Chennai") +
mapTheme(),nrow = 1
)
temp <- read.csv("https://drive.google.com/file/d/1xtwbhs6bHGufxMK6-BjZO7mPECRmIzeW/view?usp=drive_link")
id <- '1xtwbhs6bHGufxMK6-BjZO7mPECRmIzeW'
temp <- read.csv(sprintf("https://docs.google.com/uc?id=%s&export=download", id))
View(temp)
id_chen_bdry <- '1DTpA24uW8h69gpmBbvE6CdtAEJLI2IEi'
chen_bdry <- st_read(sprintf("https://docs.google.com/uc?id=%s&export=download", id))
id_chen_bdry <- '1DTpA24uW8h69gpmBbvE6CdtAEJLI2IEi'
chen_bdry <- st_read(sprintf("https://docs.google.com/uc?id=%s&export=download", id))
id_chen_bdry <- '1DTpA24uW8h69gpmBbvE6CdtAEJLI2IEi'
url <-sprintf("https://docs.google.com/uc?id=%s&export=download", id)
temp_file <- tempfile()
GET(url, write_disk(temp_file, overwrite = TRUE))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(sf)
library(RSocrata)
library(viridis)
library(spatstat)
library(raster)
library(spdep)
library(FNN)
library(grid)
library(gridExtra)
library(knitr)
library(kableExtra)
library(tidycensus)
library(classInt)
library(RCurl)
library(httr)
id_chen_bdry <- '1DTpA24uW8h69gpmBbvE6CdtAEJLI2IEi'
url <-sprintf("https://docs.google.com/uc?id=%s&export=download", id)
temp_file <- tempfile()
GET(url, write_disk(temp_file, overwrite = TRUE))
id_chen_bdry <- '1DTpA24uW8h69gpmBbvE6CdtAEJLI2IEi'
url <-sprintf("https://docs.google.com/uc?id=%s&export=download", id)
temp_file <- tempfile()
GET(url, write_disk(temp_file, overwrite = TRUE))
chen_bdry <- st_read(temp_file)
?st_drivers()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(sf)
library(RSocrata)
library(viridis)
library(spatstat)
library(raster)
library(spdep)
library(FNN)
library(grid)
library(gridExtra)
library(knitr)
library(kableExtra)
library(tidycensus)
library(classInt)
library(RCurl)
library(httr)
palette6 <- c("#264653","#2a9d8f",'#8AB17D',"#e9c46a",'#f4a261',"#e76f51")
palette5 <- c("#264653","#2a9d8f","#e9c46a",'#f4a261',"#e76f51")
palette4 <- c("#264653","#2a9d8f","#e9c46a","#e76f51")
palette2 <- c("#264653","#2a9d8f")
source("https://raw.githubusercontent.com/urbanSpatial/Public-Policy-Analytics-Landing/master/functions.r")
litter <- read.csv('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/mdt-dataChennai.csv')
litter_p <- litter%>%
filter(master_material == 'PLASTIC')%>%
st_as_sf(coords = c("longitude", "latitude"), crs = 4326, agr = "constant")%>%
st_transform('EPSG:32643')
chen_bdry <- st_read('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/gcc-divisions-latest.kml')
chen_bdry <- st_set_crs(chen_bdry, 4326)%>%
st_transform('EPSG:32643')
chen_zone <- st_read('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/gcc-zones-latest.kml')%>%
st_transform('EPSG:32643')
chen_slum <- st_read('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/chennai_slums.kml')%>%
st_transform('EPSG:32643')
chen_slum_bdry <- st_read("https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/chennai_slum_boundaries.kml")%>%
st_transform('EPSG:32643')
chen_pop <- read.csv('https://raw.githubusercontent.com/TrevorKap/MUSA810-Marine-Pollution/main/Data/Chennai_pop_2020estimation.csv')
grid.arrange(
ggplot(litter_p, aes(x = quantity)) +
geom_bar() +
theme_minimal() +
labs(title = "Count of Quantity Per Record",
x = "Category",
y = "Count"),
ggplot(litter_p, aes(x = altitude)) +
geom_histogram() +
theme_minimal() +
labs(title = "Altitude Histogram",
x = "Category",
y = "Count"),
ggplot(litter_p, aes(x = radius)) +
geom_histogram() +
theme_minimal() +
labs(title = "Radius Histogram",
x = "Category",
y = "Count"),
ncol = 3
)
ggplot(litter_p, aes(x = master_item_name)) +
geom_bar() +
theme_minimal() +
labs(title = "Count of Main Item Category",
x = "Category",
y = "Count")+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(litter_p, aes(x = location)) +
geom_bar() +
theme_minimal() +
labs(title = "Count of Location in Litter Record",
x = "Category",
y = "Count")+
theme(axis.text.x = element_text(angle = 25,size = 6))
fishnet <-
st_make_grid(chen_bdry,
cellsize = 500,
square = TRUE) %>%
.[chen_bdry] %>%
st_sf() %>%
mutate(uniqueID = 1:n())
slum_net <-
dplyr::select(chen_slum) %>%
mutate(countslum = 1) %>%
aggregate(., fishnet, sum) %>%
mutate(countslum = replace_na(countslum, 0),
uniqueID = 1:n(),
cvID = sample(round(nrow(fishnet) / 24),
size=nrow(fishnet), replace = TRUE))
grid.arrange(
ggplot() +
geom_sf(data = slum_net, aes(fill = countslum), color = NA) +
scale_fill_viridis() +
labs(title = "Slum count for the fishnet") +
mapTheme(),
ggplot() +
geom_sf(data = chen_bdry) +
geom_sf(data = chen_slum, colour="red", size=0.2, show.legend = "point") +
labs(title= "Slum, Chennai") +
mapTheme(title_size = 14),
nrow = 1
)
chen_pop_sp <- merge(chen_bdry, chen_pop, by.x = 'Name', by.y = 'Div', all.x = TRUE)
grid.arrange(
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationEsti2020), color = NA) +
scale_fill_viridis() +
labs(title = "Popultion in Chennai") +
mapTheme(),
ggplot() +
geom_sf(data = chen_pop_sp, aes(fill = PopulationDensity), color = NA) +
scale_fill_viridis() +
labs(title = "Pop Density in Chennai") +
mapTheme(),nrow = 1
)
grid.arrange(
ggplot() +
geom_sf(data = chen_bdry) +
geom_sf(data = litter_p, colour="red", size=0.2, show.legend = "point") +
labs(title= "Litter, Chennai") +
mapTheme(title_size = 14),
ggplot() +
geom_sf(data = chen_bdry, fill = "grey40") +
stat_density2d(data = data.frame(st_coordinates(litter_p)),
aes(X, Y, fill = ..level.., alpha = ..level..),
size = 0.01, bins = 80, geom = 'polygon') +
scale_fill_viridis() +
scale_alpha(range = c(0.00, 0.35), guide = FALSE) +
labs(title = "Density of Litter, Chennai") +
mapTheme(title_size = 14) + theme(legend.position = "none"),
nrow=1
)
fishnet <-
st_make_grid(chen_bdry,
cellsize = 500,
square = TRUE) %>%
.[chen_bdry] %>%
st_sf() %>%
mutate(uniqueID = 1:n())
litter_net <-
dplyr::select(litter_p) %>%
mutate(countlitter = 1) %>%
aggregate(., fishnet, sum) %>%
mutate(countlitter = replace_na(countlitter, 0),
uniqueID = 1:n(),
cvID = sample(round(nrow(fishnet) / 24),
size=nrow(fishnet), replace = TRUE))
ggplot() +
geom_sf(data = litter_net, aes(fill = countlitter), color = NA) +
scale_fill_viridis() +
labs(title = "Count of Litter for the fishnet") +
mapTheme()
l_p <- litter_p%>%
dplyr::select(list_name,geometry)
vars_net <- l_p%>%
st_join(fishnet, join=st_within) %>%
st_drop_geometry() %>%
group_by(uniqueID,list_name) %>%
summarize(count = n()) %>%
left_join(fishnet, ., by = "uniqueID") %>%
spread(list_name, count, fill=0) %>%
dplyr::select(-`<NA>`) %>%
ungroup()
st_c    <- st_coordinates
st_coid <- st_centroid
vars_net <- vars_net %>%
mutate(litter.nn = nn_function(st_c(st_coid(vars_net)),
st_c(l_p),
k = 3))
## Visualize the NN feature
vars_net.long.nn <-
dplyr::select(vars_net, ends_with(".nn")) %>%
gather(Variable, value, -geometry)
ggplot() +
geom_sf(data = vars_net.long.nn, aes(fill=value), colour=NA) +
scale_fill_viridis(name="NN Distance") +
labs(title="Litter NN Distance") +
mapTheme()
